#!/usr/bin/env bash
set -eo pipefail

GREEN='\033[1;32m'
RED='\033[1;31m'
NC='\033[0m'
CHECK_MARK="\xE2\x9C\x94"
CROSS_MARK="\xE2\x9D\x8C"

log(){ echo -e "$*" >&2; }
die(){ log "\n${RED}${CROSS_MARK} [ERROR] $*${NC}"; exit 1; }

paths=(src/ tests/)

log "ğŸ§¹ [ruff] Linting (no fixes)..."
ruff check "${paths[@]}" || die "ruff lint failed. run: ruff check --fix ${paths[*]}"

log "ğŸ¨ [ruff] Formatting check..."
ruff format --check "${paths[@]}" || die "ruff format failed. run: ruff format ${paths[*]}"

log "ğŸ” [mypy] Static type checking..."
mypy src || die "mypy failed."

log "\n${GREEN}${CHECK_MARK} All checks passed!${NC}"
